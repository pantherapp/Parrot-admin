{"ast":null,"code":"import _objectWithoutProperties from\"/Users/yrm/Sites/parrot/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _slicedToArray from\"/Users/yrm/Sites/parrot/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{List,Datagrid,TextField,Show,SimpleShowLayout}from'react-admin';import{useDataProvider,Loading,Error}from'react-admin';import Table from'@material-ui/core/Table';import TableBody from'@material-ui/core/TableBody';import TableCell from'@material-ui/core/TableCell';import TableHead from'@material-ui/core/TableHead';import TableRow from'@material-ui/core/TableRow';var Comment=function Comment(_ref){var record=_ref.record;var dataProvider=useDataProvider();var _useState=useState(),_useState2=_slicedToArray(_useState,2),total=_useState2[0],setTotal=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];useEffect(function(){dataProvider.getList('comments',{pagination:{page:1,perPage:100000},sort:{},filter:{voice_doc_id:record.id}}).then(function(_ref2){var data=_ref2.data,total=_ref2.total;setTotal(total);setLoading(false);}).catch(function(error){setError(error);setLoading(false);});},[]);var comments={result:total+\"  Comments\"};if(loading)return/*#__PURE__*/React.createElement(Loading,null);if(error)return/*#__PURE__*/React.createElement(Error,null);if(!total)return/*#__PURE__*/React.createElement(TextField,{record:comments,source:\"result\"});return/*#__PURE__*/React.createElement(TextField,{record:comments,source:\"result\"});};var reports={no:\"No Report\",yes:\"Reported by user\"};var ConditionBooleanField=function ConditionBooleanField(_ref3){var record=_ref3.record,rest=_objectWithoutProperties(_ref3,[\"record\"]);return record.report_users?/*#__PURE__*/React.createElement(TextField,{record:reports,source:\"yes\"}):/*#__PURE__*/React.createElement(TextField,{record:reports,source:\"no\"});};ConditionBooleanField.defaultProps={addLabel:true};var Player=function Player(_ref4){var record=_ref4.record;return/*#__PURE__*/React.createElement(\"audio\",{controls:true,src:record.voice_url});};Player.defaultProps={addLabel:true};var CommentGrid=function CommentGrid(_ref5){var record=_ref5.record;var dataProvider=useDataProvider();var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),total=_useState8[0],setTotal=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),data=_useState10[0],setData=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),loading=_useState12[0],setLoading=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),error=_useState14[0],setError=_useState14[1];var comments={no:\"No Comment\"};useEffect(function(){dataProvider.getList('comments',{pagination:{page:1,perPage:100000},sort:{},filter:{voice_doc_id:record.id}}).then(function(_ref6){var data=_ref6.data,total=_ref6.total;setTotal(total);setData(data);setLoading(false);}).catch(function(error){setError(error);setLoading(false);});},[]);if(loading)return/*#__PURE__*/React.createElement(Loading,null);if(error)return/*#__PURE__*/React.createElement(Error,null);if(!total)return/*#__PURE__*/React.createElement(TextField,{record:comments,source:\"no\"});if(!data)return[];return/*#__PURE__*/React.createElement(Table,null,/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,null,\"Address\"),/*#__PURE__*/React.createElement(TableCell,null,\"Voice\"))),/*#__PURE__*/React.createElement(TableBody,null,data.map(function(value){return/*#__PURE__*/React.createElement(TableRow,{key:value.created_timestamp},/*#__PURE__*/React.createElement(TableCell,null,value.address),/*#__PURE__*/React.createElement(TableCell,null,/*#__PURE__*/React.createElement(\"audio\",{controls:true,src:value.voice_url})));})));};CommentGrid.defaultProps={addLabel:true};export var VoiceList=function VoiceList(props){return/*#__PURE__*/React.createElement(List,props,/*#__PURE__*/React.createElement(Datagrid,{rowClick:\"show\"},/*#__PURE__*/React.createElement(TextField,{label:\"Location\",source:\"address\"}),/*#__PURE__*/React.createElement(Comment,{label:\"Comments\",source:\"id\"}),/*#__PURE__*/React.createElement(Player,{label:\"Voice\",source:\"voice_url\"}),/*#__PURE__*/React.createElement(ConditionBooleanField,{source:\"report_users\"})));};export var VoiceShow=function VoiceShow(props){return/*#__PURE__*/React.createElement(Show,props,/*#__PURE__*/React.createElement(SimpleShowLayout,null,/*#__PURE__*/React.createElement(TextField,{source:\"address\"}),/*#__PURE__*/React.createElement(Player,{label:\"Voice\",source:\"voice_url\"}),/*#__PURE__*/React.createElement(CommentGrid,{label:\"Comments\",source:\"id\"}),/*#__PURE__*/React.createElement(ConditionBooleanField,{source:\"report_users\"})));};","map":{"version":3,"sources":["/Users/yrm/Sites/parrot/src/models/Voice.js"],"names":["React","useState","useEffect","List","Datagrid","TextField","Show","SimpleShowLayout","useDataProvider","Loading","Error","Table","TableBody","TableCell","TableHead","TableRow","Comment","record","dataProvider","total","setTotal","loading","setLoading","error","setError","getList","pagination","page","perPage","sort","filter","voice_doc_id","id","then","data","catch","comments","result","reports","no","yes","ConditionBooleanField","rest","report_users","defaultProps","addLabel","Player","voice_url","CommentGrid","setData","map","value","created_timestamp","address","VoiceList","props","VoiceShow"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport {\n  List,\n  Datagrid,\n  TextField,\n  Show,\n  SimpleShowLayout\n} from 'react-admin';\nimport { useDataProvider, Loading, Error } from 'react-admin';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\n\nconst Comment = ({ record }) => {\n  const dataProvider = useDataProvider();\n  const [total, setTotal] = useState();\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState();\n  useEffect(() => {\n      dataProvider.getList('comments', { pagination: { page: 1 , perPage: 100000 }, sort: {}, filter: {voice_doc_id: record.id} })\n          .then(({ data, total }) => {\n              setTotal(total);                \n              setLoading(false);\n          })\n          .catch(error => {\n              setError(error);\n              setLoading(false);\n          })\n  }, []);\n  \n  var comments = {\n    result: total + \"  Comments\"\n  }\n\n  if (loading) return <Loading />;\n  if (error) return <Error />;\n  if (!total) return <TextField record={comments} source=\"result\" />;\n\n  return (\n    <TextField record={comments} source=\"result\" />\n  )\n};\n\nconst reports = {\n  no: \"No Report\",\n  yes: \"Reported by user\"\n}\n\nconst ConditionBooleanField = ({ record, ...rest }) => {\n    return record.report_users\n        ? <TextField record={reports} source=\"yes\" />\n        : <TextField record={reports} source=\"no\" />;\n}\n\nConditionBooleanField.defaultProps = {\n  addLabel: true,\n};\n\nconst Player = ({ record }) => (\n  <audio controls src={record.voice_url} />\n);\n\nPlayer.defaultProps = {\n  addLabel: true,\n};\n\nconst CommentGrid = ({ record }) => {\n\n  const dataProvider = useDataProvider();\n  const [total, setTotal] = useState();\n  const [data, setData] = useState();\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState();\n  const comments = {\n    no: \"No Comment\"\n  }\n  useEffect(() => {\n      dataProvider.getList('comments', { pagination: { page: 1 , perPage: 100000 }, sort: {}, filter: {voice_doc_id: record.id} })\n          .then(({ data, total }) => {\n              setTotal(total);  \n              setData(data);\n              setLoading(false);\n          })\n          .catch(error => {\n              setError(error);\n              setLoading(false);\n          })\n  }, []);\n\n  if (loading) return <Loading />;\n  if (error) return <Error />;\n  if (!total) return <TextField record={comments} source=\"no\" />;\n  if (!data) return [];\n\n  return (\n    <Table>\n      <TableHead>\n        <TableRow>\n          <TableCell>Address</TableCell>\n          <TableCell>Voice</TableCell>\n        </TableRow>\n      </TableHead>\n      <TableBody>\n        {data.map(value => {\n          return (\n            <TableRow key={value.created_timestamp}>\n              <TableCell>{value.address}</TableCell>\n              <TableCell><audio controls src={value.voice_url} /></TableCell>\n            </TableRow>\n          )\n        })}\n      </TableBody>\n    </Table>\n  );\n};\n\nCommentGrid.defaultProps = {\n  addLabel: true,\n};\n\nexport const VoiceList = props => (\n  <List {...props} >\n    <Datagrid rowClick=\"show\">\n      <TextField label=\"Location\" source=\"address\" />\n      <Comment label=\"Comments\" source=\"id\" />\n      <Player label=\"Voice\" source=\"voice_url\" />\n      <ConditionBooleanField source=\"report_users\" />\n    </Datagrid>\n  </List>\n);\n\nexport const VoiceShow = props => (\n  <Show {...props}>\n    <SimpleShowLayout>\n        <TextField source=\"address\" />\n        <Player label=\"Voice\" source=\"voice_url\" />\n        <CommentGrid label=\"Comments\" source=\"id\" />\n        <ConditionBooleanField source=\"report_users\" />\n    </SimpleShowLayout>\n  </Show>\n);\n"]},"metadata":{},"sourceType":"module"}