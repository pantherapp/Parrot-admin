{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { useEffect, useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport isEqual from 'lodash/isEqual';\nimport useDataProvider from './useDataProvider';\nimport getFetchType from './getFetchType';\nimport { useSafeSetState } from '../util/hooks';\n/**\n * Lists of records are initialized to a particular object,\n * so detecting if the list is empty requires some work.\n *\n * @see src/reducer/admin/data.ts\n */\n\nvar isEmptyList = function (data) {\n  return Array.isArray(data) ? data.length === 0 : data && Object.keys(data).length === 0 && data.hasOwnProperty('fetchedAt');\n};\n/**\n * Default cache selector. Allows to cache responses by default.\n *\n * By default, custom queries are dispatched as a CUSTOM_QUERY Redux action.\n * The useDataProvider hookdispatches a CUSTOM_QUERY_SUCCESS when the response\n * comes, and the customQueries reducer stores the result in the store.\n * This selector reads the customQueries store and acts as a response cache.\n */\n\n\nvar defaultDataSelector = function (query) {\n  return function (state) {\n    var key = JSON.stringify(__assign(__assign({}, query), {\n      type: getFetchType(query.type)\n    }));\n    return state.admin.customQueries[key] ? state.admin.customQueries[key].data : undefined;\n  };\n};\n\nvar defaultTotalSelector = function (query) {\n  return function (state) {\n    var key = JSON.stringify(__assign(__assign({}, query), {\n      type: getFetchType(query.type)\n    }));\n    return state.admin.customQueries[key] ? state.admin.customQueries[key].total : null;\n  };\n};\n/**\n * Fetch the data provider through Redux, return the value from the store.\n *\n * The return value updates according to the request state:\n *\n * - start: { loading: true, loaded: false }\n * - success: { data: [data from response], total: [total from response], loading: false, loaded: true }\n * - error: { error: [error from response], loading: false, loaded: true }\n *\n * This hook will return the cached result when called a second time\n * with the same parameters, until the response arrives.\n *\n * @param {Object} query\n * @param {string} query.type The verb passed to th data provider, e.g. 'getList', 'getOne'\n * @param {string} query.resource A resource name, e.g. 'posts', 'comments'\n * @param {Object} query.payload The payload object, e.g; { post_id: 12 }\n * @param {Object} options\n * @param {string} options.action Redux action type\n * @param {Function} options.onSuccess Side effect function to be executed upon success of failure, e.g. { onSuccess: response => refresh() } }\n * @param {Function} options.onFailure Side effect function to be executed upon failure, e.g. { onFailure: error => notify(error.message) } }\n * @param {Function} dataSelector Redux selector to get the result. Required.\n * @param {Function} totalSelector Redux selector to get the total (optional, only for LIST queries)\n *\n * @returns The current request state. Destructure as { data, total, error, loading, loaded }.\n *\n * @example\n *\n * import { useQueryWithStore } from 'react-admin';\n *\n * const UserProfile = ({ record }) => {\n *     const { data, loading, error } = useQueryWithStore(\n *         {\n *             type: 'getOne',\n *             resource: 'users',\n *             payload: { id: record.id }\n *         },\n *         {},\n *         state => state.admin.resources.users.data[record.id]\n *     );\n *     if (loading) { return <Loading />; }\n *     if (error) { return <p>ERROR</p>; }\n *     return <div>User {data.username}</div>;\n * };\n */\n\n\nvar useQueryWithStore = function (query, options, dataSelector, totalSelector) {\n  if (options === void 0) {\n    options = {\n      action: 'CUSTOM_QUERY'\n    };\n  }\n\n  if (dataSelector === void 0) {\n    dataSelector = defaultDataSelector(query);\n  }\n\n  if (totalSelector === void 0) {\n    totalSelector = defaultTotalSelector(query);\n  }\n\n  var type = query.type,\n      resource = query.resource,\n      payload = query.payload;\n  var requestSignature = JSON.stringify({\n    query: query,\n    options: options\n  });\n  var requestSignatureRef = useRef(requestSignature);\n  var data = useSelector(dataSelector);\n  var total = useSelector(totalSelector);\n\n  var _a = useSafeSetState({\n    data: data,\n    total: total,\n    error: null,\n    loading: true,\n    loaded: data !== undefined && !isEmptyList(data)\n  }),\n      state = _a[0],\n      setState = _a[1];\n\n  useEffect(function () {\n    if (requestSignatureRef.current !== requestSignature) {\n      // request has changed, reset the loading state\n      requestSignatureRef.current = requestSignature;\n      setState({\n        data: data,\n        total: total,\n        error: null,\n        loading: true,\n        loaded: data !== undefined && !isEmptyList(data)\n      });\n    }\n  }, [data, requestSignature, setState, total]);\n  useEffect(function () {\n    var signaturesAreEqual = requestSignatureRef.current === requestSignature;\n\n    if (signaturesAreEqual && (!isEqual(state.data, data) || state.total !== total)) {\n      // the dataProvider response arrived in the Redux store\n      if (typeof total !== 'undefined' && isNaN(total)) {\n        console.error('Total from response is not a number. Please check your dataProvider or the API.');\n      } else {\n        setState(function (prevState) {\n          return __assign(__assign({}, prevState), {\n            data: data,\n            total: total,\n            loaded: true\n          });\n        });\n      }\n    }\n  }, [data, requestSignature, setState, state, total]);\n  var dataProvider = useDataProvider();\n  useEffect(function () {\n    setState(function (prevState) {\n      return __assign(__assign({}, prevState), {\n        loading: true\n      });\n    });\n    dataProvider[type](resource, payload, options).then(function () {\n      // We don't care about the dataProvider response here, because\n      // it was already passed to SUCCESS reducers by the dataProvider\n      // hook, and the result is available from the Redux store\n      // through the data and total selectors.\n      // In addition, if the query is optimistic, the response\n      // will be empty, so it should not be used at all.\n      if (requestSignature !== requestSignatureRef.current) {\n        return;\n      }\n\n      setState(function (prevState) {\n        return __assign(__assign({}, prevState), {\n          error: null,\n          loading: false,\n          loaded: true\n        });\n      });\n    }).catch(function (error) {\n      if (requestSignature !== requestSignatureRef.current) {\n        return;\n      }\n\n      setState({\n        error: error,\n        loading: false,\n        loaded: false\n      });\n    }); // deep equality, see https://github.com/facebook/react/issues/14476#issuecomment-471199055\n  }, [requestSignature]); // eslint-disable-line\n\n  return state;\n};\n\nexport default useQueryWithStore;","map":{"version":3,"sources":["/Users/yrm/Sites/nudge/node_modules/ra-core/esm/dataProvider/useQueryWithStore.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","useEffect","useRef","useSelector","isEqual","useDataProvider","getFetchType","useSafeSetState","isEmptyList","data","Array","isArray","keys","defaultDataSelector","query","state","key","JSON","stringify","type","admin","customQueries","undefined","defaultTotalSelector","total","useQueryWithStore","options","dataSelector","totalSelector","action","resource","payload","requestSignature","requestSignatureRef","_a","error","loading","loaded","setState","current","signaturesAreEqual","isNaN","console","prevState","dataProvider","then","catch"],"mappings":"AAAA,IAAIA,QAAQ,GAAI,QAAQ,KAAKA,QAAd,IAA2B,YAAY;AAClDA,EAAAA,QAAQ,GAAGC,MAAM,CAACC,MAAP,IAAiB,UAASC,CAAT,EAAY;AACpC,SAAK,IAAIC,CAAJ,EAAOC,CAAC,GAAG,CAAX,EAAcC,CAAC,GAAGC,SAAS,CAACC,MAAjC,EAAyCH,CAAC,GAAGC,CAA7C,EAAgDD,CAAC,EAAjD,EAAqD;AACjDD,MAAAA,CAAC,GAAGG,SAAS,CAACF,CAAD,CAAb;;AACA,WAAK,IAAII,CAAT,IAAcL,CAAd,EAAiB,IAAIH,MAAM,CAACS,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCR,CAArC,EAAwCK,CAAxC,CAAJ,EACbN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AACP;;AACD,WAAON,CAAP;AACH,GAPD;;AAQA,SAAOH,QAAQ,CAACa,KAAT,CAAe,IAAf,EAAqBN,SAArB,CAAP;AACH,CAVD;;AAWA,SAASO,SAAT,EAAoBC,MAApB,QAAkC,OAAlC;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,OAAOC,OAAP,MAAoB,gBAApB;AACA,OAAOC,eAAP,MAA4B,mBAA5B;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,SAASC,eAAT,QAAgC,eAAhC;AACA;;;;;;;AAMA,IAAIC,WAAW,GAAG,UAAUC,IAAV,EAAgB;AAC9B,SAAOC,KAAK,CAACC,OAAN,CAAcF,IAAd,IACDA,IAAI,CAACd,MAAL,KAAgB,CADf,GAEDc,IAAI,IACFrB,MAAM,CAACwB,IAAP,CAAYH,IAAZ,EAAkBd,MAAlB,KAA6B,CAD/B,IAEEc,IAAI,CAACX,cAAL,CAAoB,WAApB,CAJR;AAKH,CAND;AAOA;;;;;;;;;;AAQA,IAAIe,mBAAmB,GAAG,UAAUC,KAAV,EAAiB;AAAE,SAAO,UAAUC,KAAV,EAAiB;AACjE,QAAIC,GAAG,GAAGC,IAAI,CAACC,SAAL,CAAe/B,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK2B,KAAL,CAAT,EAAsB;AAAEK,MAAAA,IAAI,EAAEb,YAAY,CAACQ,KAAK,CAACK,IAAP;AAApB,KAAtB,CAAvB,CAAV;AACA,WAAOJ,KAAK,CAACK,KAAN,CAAYC,aAAZ,CAA0BL,GAA1B,IACDD,KAAK,CAACK,KAAN,CAAYC,aAAZ,CAA0BL,GAA1B,EAA+BP,IAD9B,GAEDa,SAFN;AAGH,GAL4C;AAKzC,CALJ;;AAMA,IAAIC,oBAAoB,GAAG,UAAUT,KAAV,EAAiB;AAAE,SAAO,UAAUC,KAAV,EAAiB;AAClE,QAAIC,GAAG,GAAGC,IAAI,CAACC,SAAL,CAAe/B,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK2B,KAAL,CAAT,EAAsB;AAAEK,MAAAA,IAAI,EAAEb,YAAY,CAACQ,KAAK,CAACK,IAAP;AAApB,KAAtB,CAAvB,CAAV;AACA,WAAOJ,KAAK,CAACK,KAAN,CAAYC,aAAZ,CAA0BL,GAA1B,IACDD,KAAK,CAACK,KAAN,CAAYC,aAAZ,CAA0BL,GAA1B,EAA+BQ,KAD9B,GAED,IAFN;AAGH,GAL6C;AAK1C,CALJ;AAMA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA,IAAIC,iBAAiB,GAAG,UAAUX,KAAV,EAAiBY,OAAjB,EAA0BC,YAA1B,EAAwCC,aAAxC,EAAuD;AAC3E,MAAIF,OAAO,KAAK,KAAK,CAArB,EAAwB;AAAEA,IAAAA,OAAO,GAAG;AAAEG,MAAAA,MAAM,EAAE;AAAV,KAAV;AAAuC;;AACjE,MAAIF,YAAY,KAAK,KAAK,CAA1B,EAA6B;AAAEA,IAAAA,YAAY,GAAGd,mBAAmB,CAACC,KAAD,CAAlC;AAA4C;;AAC3E,MAAIc,aAAa,KAAK,KAAK,CAA3B,EAA8B;AAAEA,IAAAA,aAAa,GAAGL,oBAAoB,CAACT,KAAD,CAApC;AAA8C;;AAC9E,MAAIK,IAAI,GAAGL,KAAK,CAACK,IAAjB;AAAA,MAAuBW,QAAQ,GAAGhB,KAAK,CAACgB,QAAxC;AAAA,MAAkDC,OAAO,GAAGjB,KAAK,CAACiB,OAAlE;AACA,MAAIC,gBAAgB,GAAGf,IAAI,CAACC,SAAL,CAAe;AAAEJ,IAAAA,KAAK,EAAEA,KAAT;AAAgBY,IAAAA,OAAO,EAAEA;AAAzB,GAAf,CAAvB;AACA,MAAIO,mBAAmB,GAAG/B,MAAM,CAAC8B,gBAAD,CAAhC;AACA,MAAIvB,IAAI,GAAGN,WAAW,CAACwB,YAAD,CAAtB;AACA,MAAIH,KAAK,GAAGrB,WAAW,CAACyB,aAAD,CAAvB;;AACA,MAAIM,EAAE,GAAG3B,eAAe,CAAC;AACrBE,IAAAA,IAAI,EAAEA,IADe;AAErBe,IAAAA,KAAK,EAAEA,KAFc;AAGrBW,IAAAA,KAAK,EAAE,IAHc;AAIrBC,IAAAA,OAAO,EAAE,IAJY;AAKrBC,IAAAA,MAAM,EAAE5B,IAAI,KAAKa,SAAT,IAAsB,CAACd,WAAW,CAACC,IAAD;AALrB,GAAD,CAAxB;AAAA,MAMIM,KAAK,GAAGmB,EAAE,CAAC,CAAD,CANd;AAAA,MAMmBI,QAAQ,GAAGJ,EAAE,CAAC,CAAD,CANhC;;AAOAjC,EAAAA,SAAS,CAAC,YAAY;AAClB,QAAIgC,mBAAmB,CAACM,OAApB,KAAgCP,gBAApC,EAAsD;AAClD;AACAC,MAAAA,mBAAmB,CAACM,OAApB,GAA8BP,gBAA9B;AACAM,MAAAA,QAAQ,CAAC;AACL7B,QAAAA,IAAI,EAAEA,IADD;AAELe,QAAAA,KAAK,EAAEA,KAFF;AAGLW,QAAAA,KAAK,EAAE,IAHF;AAILC,QAAAA,OAAO,EAAE,IAJJ;AAKLC,QAAAA,MAAM,EAAE5B,IAAI,KAAKa,SAAT,IAAsB,CAACd,WAAW,CAACC,IAAD;AALrC,OAAD,CAAR;AAOH;AACJ,GAZQ,EAYN,CAACA,IAAD,EAAOuB,gBAAP,EAAyBM,QAAzB,EAAmCd,KAAnC,CAZM,CAAT;AAaAvB,EAAAA,SAAS,CAAC,YAAY;AAClB,QAAIuC,kBAAkB,GAAGP,mBAAmB,CAACM,OAApB,KAAgCP,gBAAzD;;AACA,QAAIQ,kBAAkB,KACjB,CAACpC,OAAO,CAACW,KAAK,CAACN,IAAP,EAAaA,IAAb,CAAR,IAA8BM,KAAK,CAACS,KAAN,KAAgBA,KAD7B,CAAtB,EAC2D;AACvD;AACA,UAAI,OAAOA,KAAP,KAAiB,WAAjB,IAAgCiB,KAAK,CAACjB,KAAD,CAAzC,EAAkD;AAC9CkB,QAAAA,OAAO,CAACP,KAAR,CAAc,iFAAd;AACH,OAFD,MAGK;AACDG,QAAAA,QAAQ,CAAC,UAAUK,SAAV,EAAqB;AAAE,iBAAQxD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKwD,SAAL,CAAT,EAA0B;AAAElC,YAAAA,IAAI,EAAEA,IAAR;AACtEe,YAAAA,KAAK,EAAEA,KAD+D;AACxDa,YAAAA,MAAM,EAAE;AADgD,WAA1B,CAAhB;AACK,SAD7B,CAAR;AAEH;AACJ;AACJ,GAbQ,EAaN,CAAC5B,IAAD,EAAOuB,gBAAP,EAAyBM,QAAzB,EAAmCvB,KAAnC,EAA0CS,KAA1C,CAbM,CAAT;AAcA,MAAIoB,YAAY,GAAGvC,eAAe,EAAlC;AACAJ,EAAAA,SAAS,CAAC,YAAY;AAClBqC,IAAAA,QAAQ,CAAC,UAAUK,SAAV,EAAqB;AAAE,aAAQxD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKwD,SAAL,CAAT,EAA0B;AAAEP,QAAAA,OAAO,EAAE;AAAX,OAA1B,CAAhB;AAAgE,KAAxF,CAAR;AACAQ,IAAAA,YAAY,CAACzB,IAAD,CAAZ,CAAmBW,QAAnB,EAA6BC,OAA7B,EAAsCL,OAAtC,EACKmB,IADL,CACU,YAAY;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,UAAIb,gBAAgB,KAAKC,mBAAmB,CAACM,OAA7C,EAAsD;AAClD;AACH;;AACDD,MAAAA,QAAQ,CAAC,UAAUK,SAAV,EAAqB;AAAE,eAAQxD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKwD,SAAL,CAAT,EAA0B;AAAER,UAAAA,KAAK,EAAE,IAAT;AAAeC,UAAAA,OAAO,EAAE,KAAxB;AAA+BC,UAAAA,MAAM,EAAE;AAAvC,SAA1B,CAAhB;AAA4F,OAApH,CAAR;AACH,KAZD,EAaKS,KAbL,CAaW,UAAUX,KAAV,EAAiB;AACxB,UAAIH,gBAAgB,KAAKC,mBAAmB,CAACM,OAA7C,EAAsD;AAClD;AACH;;AACDD,MAAAA,QAAQ,CAAC;AACLH,QAAAA,KAAK,EAAEA,KADF;AAELC,QAAAA,OAAO,EAAE,KAFJ;AAGLC,QAAAA,MAAM,EAAE;AAHH,OAAD,CAAR;AAKH,KAtBD,EAFkB,CAyBlB;AACH,GA1BQ,EA0BN,CAACL,gBAAD,CA1BM,CAAT,CA5C2E,CAsEnD;;AACxB,SAAOjB,KAAP;AACH,CAxED;;AAyEA,eAAeU,iBAAf","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { useEffect, useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport isEqual from 'lodash/isEqual';\nimport useDataProvider from './useDataProvider';\nimport getFetchType from './getFetchType';\nimport { useSafeSetState } from '../util/hooks';\n/**\n * Lists of records are initialized to a particular object,\n * so detecting if the list is empty requires some work.\n *\n * @see src/reducer/admin/data.ts\n */\nvar isEmptyList = function (data) {\n    return Array.isArray(data)\n        ? data.length === 0\n        : data &&\n            Object.keys(data).length === 0 &&\n            data.hasOwnProperty('fetchedAt');\n};\n/**\n * Default cache selector. Allows to cache responses by default.\n *\n * By default, custom queries are dispatched as a CUSTOM_QUERY Redux action.\n * The useDataProvider hookdispatches a CUSTOM_QUERY_SUCCESS when the response\n * comes, and the customQueries reducer stores the result in the store.\n * This selector reads the customQueries store and acts as a response cache.\n */\nvar defaultDataSelector = function (query) { return function (state) {\n    var key = JSON.stringify(__assign(__assign({}, query), { type: getFetchType(query.type) }));\n    return state.admin.customQueries[key]\n        ? state.admin.customQueries[key].data\n        : undefined;\n}; };\nvar defaultTotalSelector = function (query) { return function (state) {\n    var key = JSON.stringify(__assign(__assign({}, query), { type: getFetchType(query.type) }));\n    return state.admin.customQueries[key]\n        ? state.admin.customQueries[key].total\n        : null;\n}; };\n/**\n * Fetch the data provider through Redux, return the value from the store.\n *\n * The return value updates according to the request state:\n *\n * - start: { loading: true, loaded: false }\n * - success: { data: [data from response], total: [total from response], loading: false, loaded: true }\n * - error: { error: [error from response], loading: false, loaded: true }\n *\n * This hook will return the cached result when called a second time\n * with the same parameters, until the response arrives.\n *\n * @param {Object} query\n * @param {string} query.type The verb passed to th data provider, e.g. 'getList', 'getOne'\n * @param {string} query.resource A resource name, e.g. 'posts', 'comments'\n * @param {Object} query.payload The payload object, e.g; { post_id: 12 }\n * @param {Object} options\n * @param {string} options.action Redux action type\n * @param {Function} options.onSuccess Side effect function to be executed upon success of failure, e.g. { onSuccess: response => refresh() } }\n * @param {Function} options.onFailure Side effect function to be executed upon failure, e.g. { onFailure: error => notify(error.message) } }\n * @param {Function} dataSelector Redux selector to get the result. Required.\n * @param {Function} totalSelector Redux selector to get the total (optional, only for LIST queries)\n *\n * @returns The current request state. Destructure as { data, total, error, loading, loaded }.\n *\n * @example\n *\n * import { useQueryWithStore } from 'react-admin';\n *\n * const UserProfile = ({ record }) => {\n *     const { data, loading, error } = useQueryWithStore(\n *         {\n *             type: 'getOne',\n *             resource: 'users',\n *             payload: { id: record.id }\n *         },\n *         {},\n *         state => state.admin.resources.users.data[record.id]\n *     );\n *     if (loading) { return <Loading />; }\n *     if (error) { return <p>ERROR</p>; }\n *     return <div>User {data.username}</div>;\n * };\n */\nvar useQueryWithStore = function (query, options, dataSelector, totalSelector) {\n    if (options === void 0) { options = { action: 'CUSTOM_QUERY' }; }\n    if (dataSelector === void 0) { dataSelector = defaultDataSelector(query); }\n    if (totalSelector === void 0) { totalSelector = defaultTotalSelector(query); }\n    var type = query.type, resource = query.resource, payload = query.payload;\n    var requestSignature = JSON.stringify({ query: query, options: options });\n    var requestSignatureRef = useRef(requestSignature);\n    var data = useSelector(dataSelector);\n    var total = useSelector(totalSelector);\n    var _a = useSafeSetState({\n        data: data,\n        total: total,\n        error: null,\n        loading: true,\n        loaded: data !== undefined && !isEmptyList(data),\n    }), state = _a[0], setState = _a[1];\n    useEffect(function () {\n        if (requestSignatureRef.current !== requestSignature) {\n            // request has changed, reset the loading state\n            requestSignatureRef.current = requestSignature;\n            setState({\n                data: data,\n                total: total,\n                error: null,\n                loading: true,\n                loaded: data !== undefined && !isEmptyList(data),\n            });\n        }\n    }, [data, requestSignature, setState, total]);\n    useEffect(function () {\n        var signaturesAreEqual = requestSignatureRef.current === requestSignature;\n        if (signaturesAreEqual &&\n            (!isEqual(state.data, data) || state.total !== total)) {\n            // the dataProvider response arrived in the Redux store\n            if (typeof total !== 'undefined' && isNaN(total)) {\n                console.error('Total from response is not a number. Please check your dataProvider or the API.');\n            }\n            else {\n                setState(function (prevState) { return (__assign(__assign({}, prevState), { data: data,\n                    total: total, loaded: true })); });\n            }\n        }\n    }, [data, requestSignature, setState, state, total]);\n    var dataProvider = useDataProvider();\n    useEffect(function () {\n        setState(function (prevState) { return (__assign(__assign({}, prevState), { loading: true })); });\n        dataProvider[type](resource, payload, options)\n            .then(function () {\n            // We don't care about the dataProvider response here, because\n            // it was already passed to SUCCESS reducers by the dataProvider\n            // hook, and the result is available from the Redux store\n            // through the data and total selectors.\n            // In addition, if the query is optimistic, the response\n            // will be empty, so it should not be used at all.\n            if (requestSignature !== requestSignatureRef.current) {\n                return;\n            }\n            setState(function (prevState) { return (__assign(__assign({}, prevState), { error: null, loading: false, loaded: true })); });\n        })\n            .catch(function (error) {\n            if (requestSignature !== requestSignatureRef.current) {\n                return;\n            }\n            setState({\n                error: error,\n                loading: false,\n                loaded: false,\n            });\n        });\n        // deep equality, see https://github.com/facebook/react/issues/14476#issuecomment-471199055\n    }, [requestSignature]); // eslint-disable-line\n    return state;\n};\nexport default useQueryWithStore;\n"]},"metadata":{},"sourceType":"module"}