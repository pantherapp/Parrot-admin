{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { useEffect, useRef, useState, useCallback } from 'react';\nimport debounce from 'lodash/debounce';\n\nvar defaultFilterToQuery = function defaultFilterToQuery(v) {\n  return {\n    q: v\n  };\n};\n\nvar emptyFilter = {};\n/**\n * Hooks to provide filter state and setFilter which update the query part of the filter\n *\n * @example\n *\n * const { filter, setFilter } = useFilter({\n *      filterToQuery: v => ({ query: v }),\n *      permanentFilter: { foo: 'bar' },\n *      debounceTime: 500,\n * });\n * // filter inital value:\n * {\n *      query: '',\n *      foo: 'bar'\n * }\n *  // after updating filter\n *  setFilter('needle');\n *  {\n *      query: 'needle',\n *      foo: 'bar'\n *  }\n *\n * @param {Object} option\n * @param {Function} option.filterToQuery Function to convert the filter string to a filter object. Defaults to v => ({ q: v }).\n * @param {Object} option.permanentFilter Permanent filter to be merged with the filter string. Defaults to {}.\n * @param {number} option.debounceTime Time in ms between filter updates - used to debounce the search. Defaults to 500ms.\n *\n * @returns {UseFilterStateOptions} The filter props\n */\n\nexport default (function (_a) {\n  var _b = _a.filterToQuery,\n      filterToQuery = _b === void 0 ? defaultFilterToQuery : _b,\n      _c = _a.permanentFilter,\n      permanentFilter = _c === void 0 ? emptyFilter : _c,\n      _d = _a.debounceTime,\n      debounceTime = _d === void 0 ? 500 : _d;\n  var permanentFilterProp = useRef(permanentFilter);\n  var latestValue = useRef();\n\n  var _e = useState(__assign(__assign({}, permanentFilter), filterToQuery(''))),\n      filter = _e[0],\n      setFilterValue = _e[1];\n\n  useEffect(function () {\n    if (permanentFilterProp.current !== permanentFilter) {\n      permanentFilterProp.current = permanentFilter;\n      setFilterValue(__assign(__assign({}, permanentFilter), filterToQuery(latestValue.current)));\n    }\n  }, [permanentFilter, permanentFilterProp, filterToQuery]);\n  var setFilter = useCallback(debounce(function (value) {\n    setFilterValue(__assign(__assign({}, permanentFilter), filterToQuery(value)));\n    latestValue.current = value;\n  }, debounceTime), []);\n  return {\n    filter: filter,\n    setFilter: setFilter\n  };\n});","map":{"version":3,"sources":["/Users/yrm/Sites/nudge/node_modules/ra-core/esm/controller/useFilterState.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","useEffect","useRef","useState","useCallback","debounce","defaultFilterToQuery","v","q","emptyFilter","_a","_b","filterToQuery","_c","permanentFilter","_d","debounceTime","permanentFilterProp","latestValue","_e","filter","setFilterValue","current","setFilter","value"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { useEffect, useRef, useState, useCallback } from 'react';\nimport debounce from 'lodash/debounce';\nvar defaultFilterToQuery = function (v) { return ({ q: v }); };\nvar emptyFilter = {};\n/**\n * Hooks to provide filter state and setFilter which update the query part of the filter\n *\n * @example\n *\n * const { filter, setFilter } = useFilter({\n *      filterToQuery: v => ({ query: v }),\n *      permanentFilter: { foo: 'bar' },\n *      debounceTime: 500,\n * });\n * // filter inital value:\n * {\n *      query: '',\n *      foo: 'bar'\n * }\n *  // after updating filter\n *  setFilter('needle');\n *  {\n *      query: 'needle',\n *      foo: 'bar'\n *  }\n *\n * @param {Object} option\n * @param {Function} option.filterToQuery Function to convert the filter string to a filter object. Defaults to v => ({ q: v }).\n * @param {Object} option.permanentFilter Permanent filter to be merged with the filter string. Defaults to {}.\n * @param {number} option.debounceTime Time in ms between filter updates - used to debounce the search. Defaults to 500ms.\n *\n * @returns {UseFilterStateOptions} The filter props\n */\nexport default (function (_a) {\n    var _b = _a.filterToQuery, filterToQuery = _b === void 0 ? defaultFilterToQuery : _b, _c = _a.permanentFilter, permanentFilter = _c === void 0 ? emptyFilter : _c, _d = _a.debounceTime, debounceTime = _d === void 0 ? 500 : _d;\n    var permanentFilterProp = useRef(permanentFilter);\n    var latestValue = useRef();\n    var _e = useState(__assign(__assign({}, permanentFilter), filterToQuery(''))), filter = _e[0], setFilterValue = _e[1];\n    useEffect(function () {\n        if (permanentFilterProp.current !== permanentFilter) {\n            permanentFilterProp.current = permanentFilter;\n            setFilterValue(__assign(__assign({}, permanentFilter), filterToQuery(latestValue.current)));\n        }\n    }, [permanentFilter, permanentFilterProp, filterToQuery]);\n    var setFilter = useCallback(debounce(function (value) {\n        setFilterValue(__assign(__assign({}, permanentFilter), filterToQuery(value)));\n        latestValue.current = value;\n    }, debounceTime), []);\n    return {\n        filter: filter,\n        setFilter: setFilter,\n    };\n});\n"]},"metadata":{},"sourceType":"module"}